function u(c,e){return c<<e|c>>32-e&4294967295}function v(c,e){var d=53421250;c+=2997784595;e+=752410698;d^=e;d-=u(e,14);c^=d;c-=u(d,11);e^=c;e-=u(c,25);d^=e;d-=u(e,16);c^=d;c-=u(d,4);e^=c;e-=u(c,14);d^=e;d-=u(e,24);return d&65535}function x(c,e,d,f,g,i,h){c[e+d*33]=f+(0|g*(v(e+i,d+h)-32768)/25600)}function y(c,e,d){c[e+d*33]=Math.max(0,7*Math.min(65535,c[e+d*33])/65536)}
function z(c,e,d,f,g,i){if(!(f<=1)){var h=f>>1,j=c[e+d*33],m=c[e+f+d*33],w=c[e+(d+f)*33],r=c[e+f+(d+f)*33];x(c,e+h,d,j+m>>1,f<<8,g,i);x(c,e+h,d+f,w+r>>1,f<<8,g,i);x(c,e,d+h,j+w>>1,f<<8,g,i);x(c,e+f,d+h,m+r>>1,f<<8,g,i);x(c,e+h,d+h,j+m+w+r>>2,362*f,g,i);z(c,e,d,h,g,i);z(c,e+h,d,h,g,i);z(c,e,d+h,h,g,i);z(c,e+h,d+h,h,g,i);y(c,e+h,d);y(c,e+h,d+f);y(c,e,d+h);y(c,e+f,d+h);y(c,e+h,d+h)}}var A={};
function B(c,e){A[e]||(A[e]={});if(A[e][c])return A[e][c];var d=A[e],f=c<<5,g=e<<5,i=[];i[0]=v(f,g);i[32]=v(f+32,g);i[1056]=v(f,32+g);i[1088]=v(f+32,g+32);z(i,0,0,32,f,g);y(i,0,0);y(i,0,32);y(i,32,0);y(i,32,32);d[c]=i;return A[e][c]};var C=[0,0,1,1,1,0,-1,-1,-1],G=[0,-1,-1,0,1,1,1,0,-1],H=[0,0,0,1,2,2,2,3,0],I=[[],[1,1,12],[-1,1,-4],[0,1,12],[1,-1,-4],[1,0,12],[-1,1,-4,1,-1,-4],[1,1,28],[-1,-1,-20],[1,1,12,-1,-1,-20],[-1,0,-4],[-1,1,12],[0,-1,-4],[1,-1,12],[-1,-1,-4],[]],J=0;function K(){return((new Date).getTime()>>5)+J}function L(c,e,d,f,g,i,h){this.n=0;this.m=c;this.h=e;this.x=d;this.y=f;this.c=h;this.o=g;this.p=i;this.f=B(d>>9,f>>9);this.l=2;this.k=5;this.i=48*g;this.j=72*i;this.g=2;this.d=0}
function M(c,e,d){e.style.backgroundPosition=-(c.i+[1,2,1,0][c.d/6|0]*16)+"px "+-(c.j+c.g*18)+"px";var f=c.y&511,g=(c.x>>9&1)+(c.y>>9&1)*2;e.style.left=(c.x&511)-8+"px";e.style.top=f-12+"px";e.style.zIndex=10+f;if(c.e!=g){c.e&&d[c.e].removeChild(e);d[g].appendChild(e);c.e=g}}function N(c,e,d,f,g){var i=g,h=g;if(d>0)i=(16-c)/d;if(d<0)i=(-1-c)/d;if(f>0)h=(16-e)/f;if(f<0)h=(-1-e)/f;return Math.min(i,h,g)}
L.prototype.update=function(c){if(this.c!=0){var e=C[this.c]*3,d=G[this.c]*3,f=c-this.h;this.d+=f;this.d%=24;for(var g=this.l,i=this.k,h=this.f,j=this.x,m=this.y,w=j>>9,r=m>>9;f>0;){var k=j>>4&31,n=m>>4&31,l=f;k=I[(h[k+n*33]<g||h[k+n*33]>i?1:0)|(h[k+n*33+1]<g||h[k+n*33+1]>i?2:0)|(h[k+n*33+33]<g||h[k+n*33+33]>i?4:0)|(h[k+n*33+34]<g||h[k+n*33+34]>i?8:0)];n=0;for(var s=j&15,p=m&15,o=0;o<k.length;o+=3){var D=k[o],E=k[o+1];l=k[o+2];var q=e*D+d*E;if(q<0){q=(l-D*s-E*p)/q;if(q>f)q=f;j+=e*q|0;m+=d*q|0;s+=
e*q|0;p+=d*q|0;f-=q;n=1;var F=-E*e+D*d;l=N(s,p,-E*F,D*F,f);j+=-E*F*l|0;m+=D*F*l|0;f-=l;if(q<0){f=0;n=1;break}}}if(!n){l=N(s,p,e,d,f);j+=e*l|0;m+=d*l|0;f-=l}l=j>>9;k=m>>9;if(l!=w||k!=r){h=this.f=B(l,k);w=l;r=k}}this.x=j;this.y=m}this.h=c};function O(c,e,d){c.update(e);c.c=d;if(d==0)c.d=0;else c.g=H[d]};function P(c,e,d){var f=document.createElement("div");f.style.position="absolute";f.style.background='url("'+c+'") 0 0 no-repeat';f.style.width=e+"px";f.style.height=d+"px";return f}var Q=[[],[],[],[]],R=[],S=[],T=[];
function U(c,e){for(var d=c-256>>9,f=e-256>>9,g=c-256&511,i=e-256&511,h=0;h<2;h++)for(var j=0;j<2;j++){var m=d+j&1|(f+h&1)<<1;if(R[m]!=d+j||S[m]!=f+h){var w=Q[m],r=d+j,k=f+h,n=B(r,k),l=void 0,s=void 0,p=void 0;r<<=5;k<<=5;for(p=0;p<32;p++){s=0;for(l=p*33;s<32;s++,l++){var o=n[l]|0;o=o*15*V+W[(n[l+1]|0)-o+1+((n[l+33]|0)-o+1)*3+((n[l+34]|0)-o+1)*9]+(v(r+s,k+p)&V-1);w[0].drawImage(X,16*(o&15),16*(o>>4),16,16,s*16,p*16,16,16)}}R[m]=d+j;S[m]=f+h}T[m].style.left=-g+512*j+"px";T[m].style.top=-i+512*h+"px"}}
window.a=function(){var c=document.getElementById("map");Y();for(var e=0;e<4;e++){T[e]=Z(Q[e]);c.appendChild(T[e])}U(256,256);var d=new L(1,K(),256,256,1,0,0),f=P("chars.png",16,18);M(d,f,T);var g=[],i={37:"L",38:"U",39:"R",40:"D",87:"U",65:"L",83:"D",68:"R"};setInterval(function(){d.update(K());M(d,f,T);U(d.x,d.y);document.getElementById("status").innerHTML="("+d.x+","+d.y+")"},32);function h(){var j=K();if(g.U)if(g.L)O(d,j,8);else g.R?O(d,j,2):O(d,j,1);else if(g.D)if(g.L)O(d,j,6);else g.R?O(d,j,
4):O(d,j,5);else if(g.L)O(d,j,7);else g.R?O(d,j,3):O(d,j,0)}window.onkeydown=function(j){if(j.keyCode)if(i[j.keyCode]){g[i[j.keyCode]]=1;h()}};window.onkeyup=function(j){if(j.keyCode)if(i[j.keyCode]){g[i[j.keyCode]]=0;h()}}};window.b=function(){};window.t=function(){var c=document.getElementById("about");c.style.visibility=c.style.visibility=="hidden"?"visible":"hidden"};var V=4,W=[];function Y(){var c;for(c=0;c<27;c++){var e=0,d=c%3-1,f=(c/3|0)%3-1,g=(c/9|0)-1,i=0;if(d==-1||f==-1||g==-1){i=-15;e=1;d++;f++;g++}W[c]=V*(i+e+d*2+f*4+g*8)}}var X=document.createElement("img");X.src="t.gif";function Z(c){var e=document.createElement("canvas");e.width=512;e.height=512;c[0]=e.getContext("2d");c=document.createElement("div");c.appendChild(e);c.style.width="512px";c.style.height="512px";c.style.position="absolute";return c};
